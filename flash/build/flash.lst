ARM GAS  C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"flash.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.FlashRead,"ax",%progbits
  18              		.align	1
  19              		.global	FlashRead
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	FlashRead:
  27              	.LVL0:
  28              	.LFB130:
  29              		.file 1 "Core/Src/flash.c"
   1:Core/Src/flash.c **** #include "flash.h"
   2:Core/Src/flash.c **** 
   3:Core/Src/flash.c **** 
   4:Core/Src/flash.c **** void FlashRead(uint32_t address, uint8_t* buffer, uint32_t size)
   5:Core/Src/flash.c **** {
  30              		.loc 1 5 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		@ link register save eliminated.
   6:Core/Src/flash.c ****     uint8_t i;
  35              		.loc 1 6 5 view .LVU1
   7:Core/Src/flash.c ****     for(i = 0;i < size;i++)
  36              		.loc 1 7 5 view .LVU2
  37              		.loc 1 7 11 is_stmt 0 view .LVU3
  38 0000 0023     		movs	r3, #0
  39              	.LVL1:
  40              		.loc 1 7 15 is_stmt 1 view .LVU4
  41              		.loc 1 7 5 is_stmt 0 view .LVU5
  42 0002 9342     		cmp	r3, r2
  43 0004 09D2     		bcs	.L7
   5:Core/Src/flash.c ****     uint8_t i;
  44              		.loc 1 5 1 view .LVU6
  45 0006 10B4     		push	{r4}
  46              	.LCFI0:
  47              		.cfi_def_cfa_offset 4
  48              		.cfi_offset 4, -4
  49              	.L3:
   8:Core/Src/flash.c ****     {
ARM GAS  C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s 			page 2


   9:Core/Src/flash.c ****         buffer[i] = *(volatile uint8_t*) (address + i);
  50              		.loc 1 9 9 is_stmt 1 discriminator 3 view .LVU7
  51              		.loc 1 9 21 is_stmt 0 discriminator 3 view .LVU8
  52 0008 1C5C     		ldrb	r4, [r3, r0]	@ zero_extendqisi2
  53              		.loc 1 9 19 discriminator 3 view .LVU9
  54 000a CC54     		strb	r4, [r1, r3]
   7:Core/Src/flash.c ****     {
  55              		.loc 1 7 24 is_stmt 1 discriminator 3 view .LVU10
   7:Core/Src/flash.c ****     {
  56              		.loc 1 7 25 is_stmt 0 discriminator 3 view .LVU11
  57 000c 0133     		adds	r3, r3, #1
  58              	.LVL2:
   7:Core/Src/flash.c ****     {
  59              		.loc 1 7 25 discriminator 3 view .LVU12
  60 000e DBB2     		uxtb	r3, r3
  61              	.LVL3:
   7:Core/Src/flash.c ****     {
  62              		.loc 1 7 15 is_stmt 1 discriminator 3 view .LVU13
   7:Core/Src/flash.c ****     {
  63              		.loc 1 7 5 is_stmt 0 discriminator 3 view .LVU14
  64 0010 9342     		cmp	r3, r2
  65 0012 F9D3     		bcc	.L3
  10:Core/Src/flash.c ****     }
  11:Core/Src/flash.c **** }
  66              		.loc 1 11 1 view .LVU15
  67 0014 5DF8044B 		ldr	r4, [sp], #4
  68              	.LCFI1:
  69              		.cfi_restore 4
  70              		.cfi_def_cfa_offset 0
  71 0018 7047     		bx	lr
  72              	.L7:
  73              		.loc 1 11 1 view .LVU16
  74 001a 7047     		bx	lr
  75              		.cfi_endproc
  76              	.LFE130:
  78              		.section	.text.FlashEraseSector5,"ax",%progbits
  79              		.align	1
  80              		.global	FlashEraseSector5
  81              		.syntax unified
  82              		.thumb
  83              		.thumb_func
  84              		.fpu fpv4-sp-d16
  86              	FlashEraseSector5:
  87              	.LFB131:
  12:Core/Src/flash.c **** 
  13:Core/Src/flash.c **** uint8_t FlashEraseSector5()
  14:Core/Src/flash.c **** {
  88              		.loc 1 14 1 is_stmt 1 view -0
  89              		.cfi_startproc
  90              		@ args = 0, pretend = 0, frame = 24
  91              		@ frame_needed = 0, uses_anonymous_args = 0
  92 0000 00B5     		push	{lr}
  93              	.LCFI2:
  94              		.cfi_def_cfa_offset 4
  95              		.cfi_offset 14, -4
  96 0002 87B0     		sub	sp, sp, #28
  97              	.LCFI3:
ARM GAS  C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s 			page 3


  98              		.cfi_def_cfa_offset 32
  15:Core/Src/flash.c ****     FLASH_EraseInitTypeDef erase_init;
  99              		.loc 1 15 5 view .LVU18
  16:Core/Src/flash.c ****     HAL_StatusTypeDef      hal_sta;
 100              		.loc 1 16 5 view .LVU19
  17:Core/Src/flash.c ****     uint32_t               sector_error;
 101              		.loc 1 17 5 view .LVU20
  18:Core/Src/flash.c **** 
  19:Core/Src/flash.c ****     erase_init.Banks = FLASH_BANK_1;
 102              		.loc 1 19 5 view .LVU21
 103              		.loc 1 19 22 is_stmt 0 view .LVU22
 104 0004 0123     		movs	r3, #1
 105 0006 0293     		str	r3, [sp, #8]
  20:Core/Src/flash.c ****     erase_init.NbSectors = 1;
 106              		.loc 1 20 5 is_stmt 1 view .LVU23
 107              		.loc 1 20 26 is_stmt 0 view .LVU24
 108 0008 0493     		str	r3, [sp, #16]
  21:Core/Src/flash.c ****     erase_init.Sector = FLASH_SECTOR_5;
 109              		.loc 1 21 5 is_stmt 1 view .LVU25
 110              		.loc 1 21 23 is_stmt 0 view .LVU26
 111 000a 0523     		movs	r3, #5
 112 000c 0393     		str	r3, [sp, #12]
  22:Core/Src/flash.c ****     erase_init.VoltageRange = FLASH_VOLTAGE_RANGE_3;
 113              		.loc 1 22 5 is_stmt 1 view .LVU27
 114              		.loc 1 22 29 is_stmt 0 view .LVU28
 115 000e 0223     		movs	r3, #2
 116 0010 0593     		str	r3, [sp, #20]
  23:Core/Src/flash.c ****     erase_init.TypeErase = FLASH_TYPEERASE_SECTORS;
 117              		.loc 1 23 5 is_stmt 1 view .LVU29
 118              		.loc 1 23 26 is_stmt 0 view .LVU30
 119 0012 0023     		movs	r3, #0
 120 0014 0193     		str	r3, [sp, #4]
  24:Core/Src/flash.c **** 
  25:Core/Src/flash.c ****     hal_sta = HAL_FLASHEx_Erase(&erase_init,&sector_error);
 121              		.loc 1 25 5 is_stmt 1 view .LVU31
 122              		.loc 1 25 15 is_stmt 0 view .LVU32
 123 0016 6946     		mov	r1, sp
 124 0018 01A8     		add	r0, sp, #4
 125 001a FFF7FEFF 		bl	HAL_FLASHEx_Erase
 126              	.LVL4:
  26:Core/Src/flash.c **** 
  27:Core/Src/flash.c ****     if(hal_sta != HAL_OK || sector_error != 0xFFFFFFFFU) return 0;
 127              		.loc 1 27 5 is_stmt 1 view .LVU33
 128              		.loc 1 27 7 is_stmt 0 view .LVU34
 129 001e 30B9     		cbnz	r0, .L10
 130              		.loc 1 27 42 discriminator 2 view .LVU35
 131 0020 009B     		ldr	r3, [sp]
 132              		.loc 1 27 26 discriminator 2 view .LVU36
 133 0022 B3F1FF3F 		cmp	r3, #-1
 134 0026 04D0     		beq	.L13
 135              	.L9:
  28:Core/Src/flash.c ****     else return 1;
  29:Core/Src/flash.c **** 
  30:Core/Src/flash.c **** }
 136              		.loc 1 30 1 view .LVU37
 137 0028 07B0     		add	sp, sp, #28
 138              	.LCFI4:
ARM GAS  C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s 			page 4


 139              		.cfi_remember_state
 140              		.cfi_def_cfa_offset 4
 141              		@ sp needed
 142 002a 5DF804FB 		ldr	pc, [sp], #4
 143              	.L10:
 144              	.LCFI5:
 145              		.cfi_restore_state
  27:Core/Src/flash.c ****     else return 1;
 146              		.loc 1 27 65 view .LVU38
 147 002e 0020     		movs	r0, #0
 148              	.LVL5:
  27:Core/Src/flash.c ****     else return 1;
 149              		.loc 1 27 65 view .LVU39
 150 0030 FAE7     		b	.L9
 151              	.LVL6:
 152              	.L13:
  28:Core/Src/flash.c ****     else return 1;
 153              		.loc 1 28 17 view .LVU40
 154 0032 0120     		movs	r0, #1
 155 0034 F8E7     		b	.L9
 156              		.cfi_endproc
 157              	.LFE131:
 159              		.section	.text.FlashWriteWithoutErase,"ax",%progbits
 160              		.align	1
 161              		.global	FlashWriteWithoutErase
 162              		.syntax unified
 163              		.thumb
 164              		.thumb_func
 165              		.fpu fpv4-sp-d16
 167              	FlashWriteWithoutErase:
 168              	.LVL7:
 169              	.LFB132:
  31:Core/Src/flash.c **** 
  32:Core/Src/flash.c **** uint8_t FlashWriteWithoutErase(uint32_t address, uint8_t* buffer, uint32_t size)
  33:Core/Src/flash.c **** {
 170              		.loc 1 33 1 is_stmt 1 view -0
 171              		.cfi_startproc
 172              		@ args = 0, pretend = 0, frame = 0
 173              		@ frame_needed = 0, uses_anonymous_args = 0
 174              		.loc 1 33 1 is_stmt 0 view .LVU42
 175 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 176              	.LCFI6:
 177              		.cfi_def_cfa_offset 24
 178              		.cfi_offset 3, -24
 179              		.cfi_offset 4, -20
 180              		.cfi_offset 5, -16
 181              		.cfi_offset 6, -12
 182              		.cfi_offset 7, -8
 183              		.cfi_offset 14, -4
 184 0002 0746     		mov	r7, r0
 185 0004 0E46     		mov	r6, r1
 186 0006 1546     		mov	r5, r2
  34:Core/Src/flash.c ****     HAL_StatusTypeDef hal_sta = HAL_OK;
 187              		.loc 1 34 5 is_stmt 1 view .LVU43
 188              	.LVL8:
  35:Core/Src/flash.c **** 	uint32_t          pos = 0;
 189              		.loc 1 35 2 view .LVU44
ARM GAS  C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s 			page 5


  36:Core/Src/flash.c **** 
  37:Core/Src/flash.c ****     while((size > pos) && (hal_sta == HAL_OK))
 190              		.loc 1 37 5 view .LVU45
  35:Core/Src/flash.c **** 	uint32_t          pos = 0;
 191              		.loc 1 35 20 is_stmt 0 view .LVU46
 192 0008 0024     		movs	r4, #0
  34:Core/Src/flash.c **** 	uint32_t          pos = 0;
 193              		.loc 1 34 23 view .LVU47
 194 000a 2046     		mov	r0, r4
 195              	.LVL9:
 196              	.L15:
 197              		.loc 1 37 10 is_stmt 1 view .LVU48
 198 000c AC42     		cmp	r4, r5
 199 000e 08D2     		bcs	.L16
 200              		.loc 1 37 24 is_stmt 0 discriminator 1 view .LVU49
 201 0010 38B9     		cbnz	r0, .L16
  38:Core/Src/flash.c ****     {
  39:Core/Src/flash.c **** 		hal_sta = HAL_FLASH_Program(FLASH_TYPEPROGRAM_BYTE, address + pos, buffer[pos]);
 202              		.loc 1 39 3 is_stmt 1 view .LVU50
 203              		.loc 1 39 13 is_stmt 0 view .LVU51
 204 0012 325D     		ldrb	r2, [r6, r4]	@ zero_extendqisi2
 205 0014 0023     		movs	r3, #0
 206 0016 E119     		adds	r1, r4, r7
 207 0018 0020     		movs	r0, #0
 208              	.LVL10:
 209              		.loc 1 39 13 view .LVU52
 210 001a FFF7FEFF 		bl	HAL_FLASH_Program
 211              	.LVL11:
  40:Core/Src/flash.c **** 		pos++;
 212              		.loc 1 40 3 is_stmt 1 view .LVU53
 213              		.loc 1 40 6 is_stmt 0 view .LVU54
 214 001e 0134     		adds	r4, r4, #1
 215              	.LVL12:
 216              		.loc 1 40 6 view .LVU55
 217 0020 F4E7     		b	.L15
 218              	.L16:
  41:Core/Src/flash.c **** 	}
  42:Core/Src/flash.c **** 
  43:Core/Src/flash.c **** 	if(hal_sta == HAL_OK) return 1;
 219              		.loc 1 43 2 is_stmt 1 view .LVU56
 220              		.loc 1 43 4 is_stmt 0 view .LVU57
 221 0022 08B9     		cbnz	r0, .L19
 222              		.loc 1 43 31 view .LVU58
 223 0024 0120     		movs	r0, #1
 224              	.LVL13:
 225              	.L18:
  44:Core/Src/flash.c **** 	else return 0;
  45:Core/Src/flash.c **** }
 226              		.loc 1 45 1 view .LVU59
 227 0026 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 228              	.LVL14:
 229              	.L19:
  44:Core/Src/flash.c **** 	else return 0;
 230              		.loc 1 44 14 view .LVU60
 231 0028 0020     		movs	r0, #0
 232              	.LVL15:
  44:Core/Src/flash.c **** 	else return 0;
ARM GAS  C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s 			page 6


 233              		.loc 1 44 14 view .LVU61
 234 002a FCE7     		b	.L18
 235              		.cfi_endproc
 236              	.LFE132:
 238              		.section	.text.FlashWrite,"ax",%progbits
 239              		.align	1
 240              		.global	FlashWrite
 241              		.syntax unified
 242              		.thumb
 243              		.thumb_func
 244              		.fpu fpv4-sp-d16
 246              	FlashWrite:
 247              	.LVL16:
 248              	.LFB133:
  46:Core/Src/flash.c **** 
  47:Core/Src/flash.c **** uint8_t FlashWrite(uint32_t address, uint8_t* buffer, uint32_t size)
  48:Core/Src/flash.c **** {
 249              		.loc 1 48 1 is_stmt 1 view -0
 250              		.cfi_startproc
 251              		@ args = 0, pretend = 0, frame = 0
 252              		@ frame_needed = 0, uses_anonymous_args = 0
 253              		.loc 1 48 1 is_stmt 0 view .LVU63
 254 0000 70B5     		push	{r4, r5, r6, lr}
 255              	.LCFI7:
 256              		.cfi_def_cfa_offset 16
 257              		.cfi_offset 4, -16
 258              		.cfi_offset 5, -12
 259              		.cfi_offset 6, -8
 260              		.cfi_offset 14, -4
 261 0002 0446     		mov	r4, r0
 262 0004 0D46     		mov	r5, r1
 263 0006 1646     		mov	r6, r2
  49:Core/Src/flash.c ****     uint8_t write_flag;
 264              		.loc 1 49 5 is_stmt 1 view .LVU64
  50:Core/Src/flash.c ****     
  51:Core/Src/flash.c ****     HAL_FLASH_Unlock();
 265              		.loc 1 51 5 view .LVU65
 266 0008 FFF7FEFF 		bl	HAL_FLASH_Unlock
 267              	.LVL17:
  52:Core/Src/flash.c ****     FlashEraseSector5();
 268              		.loc 1 52 5 view .LVU66
 269 000c FFF7FEFF 		bl	FlashEraseSector5
 270              	.LVL18:
  53:Core/Src/flash.c ****     write_flag = FlashWriteWithoutErase(address,buffer,size);
 271              		.loc 1 53 5 view .LVU67
 272              		.loc 1 53 18 is_stmt 0 view .LVU68
 273 0010 3246     		mov	r2, r6
 274 0012 2946     		mov	r1, r5
 275 0014 2046     		mov	r0, r4
 276 0016 FFF7FEFF 		bl	FlashWriteWithoutErase
 277              	.LVL19:
 278 001a 0446     		mov	r4, r0
 279              	.LVL20:
  54:Core/Src/flash.c ****     HAL_FLASH_Lock();
 280              		.loc 1 54 5 is_stmt 1 view .LVU69
 281 001c FFF7FEFF 		bl	HAL_FLASH_Lock
 282              	.LVL21:
ARM GAS  C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s 			page 7


  55:Core/Src/flash.c **** 
  56:Core/Src/flash.c ****     return write_flag;
 283              		.loc 1 56 5 view .LVU70
  57:Core/Src/flash.c **** }...
 284              		.loc 1 57 1 is_stmt 0 view .LVU71
 285 0020 2046     		mov	r0, r4
 286 0022 70BD     		pop	{r4, r5, r6, pc}
 287              		.loc 1 57 1 view .LVU72
 288              		.cfi_endproc
 289              	.LFE133:
 291              		.text
 292              	.Letext0:
 293              		.file 2 "d:\\vs_code_stm32\\9 2019-q4-major\\arm-none-eabi\\include\\machine\\_default_types.h"
 294              		.file 3 "d:\\vs_code_stm32\\9 2019-q4-major\\arm-none-eabi\\include\\sys\\_stdint.h"
 295              		.file 4 "Drivers/CMSIS/Include/core_cm4.h"
 296              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 297              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f401xc.h"
 298              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 299              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 300              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_flash_ex.h"
 301              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_uart.h"
 302              		.file 11 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 303              		.file 12 "Core/Inc/usart.h"
 304              		.file 13 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_flash.h"
ARM GAS  C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s 			page 8


DEFINED SYMBOLS
                            *ABS*:00000000 flash.c
C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s:18     .text.FlashRead:00000000 $t
C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s:26     .text.FlashRead:00000000 FlashRead
C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s:79     .text.FlashEraseSector5:00000000 $t
C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s:86     .text.FlashEraseSector5:00000000 FlashEraseSector5
C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s:160    .text.FlashWriteWithoutErase:00000000 $t
C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s:167    .text.FlashWriteWithoutErase:00000000 FlashWriteWithoutErase
C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s:239    .text.FlashWrite:00000000 $t
C:\Users\Kiana\AppData\Local\Temp\ccajel2x.s:246    .text.FlashWrite:00000000 FlashWrite

UNDEFINED SYMBOLS
HAL_FLASHEx_Erase
HAL_FLASH_Program
HAL_FLASH_Unlock
HAL_FLASH_Lock
